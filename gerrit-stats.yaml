- publisher:
      name: save-gerrit-stats-artifacts
      publishers:
          - postbuildscript:
                mark-unstable-if-failed: true
                builders:
                    - role: BOTH # default
                      build-on:
                          - SUCCESS
                      build-steps:
                          - shell: !include-raw: gerrit-stats-saveartifacts.sh

- job:
      name: 'Gerrit-Stats'
      description: 'Generate Gerrit Stats Automatically By Jenkins Jobs'
      parameters:
          - bool:
                name: UPDATE_DATA
                default: true
                description: 'Update stats using new data set'
          - bool:
                name: UPDATE_UI
                default: false
                description: 'Update UI only'
          - string:
                name: ARTIFACT_PATH
                description: 'Where to collect artifacts'
                default: '/storage/artifacts/farm/gerrit-stats/VERSION'
      properties:
          - build-discarder:
                days-to-keep: 15
      triggers:
          - timed: '0 0 * * 0'
      builders:
          - shell: !include-raw: gerrit-stats.sh
      publishers:
          - save-gerrit-stats-artifacts
